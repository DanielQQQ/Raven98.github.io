<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/letter-r-32x32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/letter-r-32x32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/letter-r-16x16.png?v=5.1.4">


  <link rel="mask-icon" href="/images/letter-r-32x32.png?v=5.1.4" color="#222">





  <meta name="keywords" content="实习,东软睿道,Java,互联网架构,MyBatis,Spring IOC,Spring AOP," />










<meta name="description" content="Introduction 内容：Java互联网架构基础知识   时间：2019.05-07 - 2019.07.05   背景：软件学院大三下学期9学分企业项目实训  Contents Day 1 - Day 3: MyBatis Day 4 - Day 5: Spring IOC Day 6 - Day 7: Spring AOP  Day 8 - Day X: Spring MVC L">
<meta name="keywords" content="实习,东软睿道,Java,互联网架构,MyBatis,Spring IOC,Spring AOP">
<meta property="og:type" content="article">
<meta property="og:title" content="「置顶」东软睿道实训杂记">
<meta property="og:url" content="https://ravenxu.top/2019/05/08/东软睿道实训杂记/index.html">
<meta property="og:site_name" content="Blog | Raven Xu">
<meta property="og:description" content="Introduction 内容：Java互联网架构基础知识   时间：2019.05-07 - 2019.07.05   背景：软件学院大三下学期9学分企业项目实训  Contents Day 1 - Day 3: MyBatis Day 4 - Day 5: Spring IOC Day 6 - Day 7: Spring AOP  Day 8 - Day X: Spring MVC L">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://ws1.sinaimg.cn/large/006tNc79ly1g30xqf7vbvj3080037aa7.jpg">
<meta property="og:image" content="http://ws3.sinaimg.cn/large/006tNc79ly1g2sifw8z3tj30fz0aujrd.jpg">
<meta property="og:image" content="http://ws1.sinaimg.cn/large/006tNc79ly1g2uw4nfuc0j31wk0bkwit.jpg">
<meta property="og:image" content="http://ws3.sinaimg.cn/large/006tNc79ly1g2w91nprxrj31000mewkd.jpg">
<meta property="og:image" content="http://ws4.sinaimg.cn/large/006tNc79ly1g31razzyhxj30zw0m8418.jpg">
<meta property="og:updated_time" content="2019-05-15T05:00:25.987Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="「置顶」东软睿道实训杂记">
<meta name="twitter:description" content="Introduction 内容：Java互联网架构基础知识   时间：2019.05-07 - 2019.07.05   背景：软件学院大三下学期9学分企业项目实训  Contents Day 1 - Day 3: MyBatis Day 4 - Day 5: Spring IOC Day 6 - Day 7: Spring AOP  Day 8 - Day X: Spring MVC L">
<meta name="twitter:image" content="http://ws1.sinaimg.cn/large/006tNc79ly1g30xqf7vbvj3080037aa7.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://ravenxu.top/2019/05/08/东软睿道实训杂记/"/>





  <title>「置顶」东软睿道实训杂记 | Blog | Raven Xu</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
		<a href="https://github.com/Raven98/Raven98.github.io" class="github-corner" aria-label="View source on Github">
		<svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Blog | Raven Xu</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://ravenxu.top/2019/05/08/东软睿道实训杂记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Raven Xu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog | Raven Xu">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">「置顶」东软睿道实训杂记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-05-08T10:00:00+08:00">
                2019-05-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/05/08/东软睿道实训杂记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2019/05/08/东软睿道实训杂记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="http://ws1.sinaimg.cn/large/006tNc79ly1g30xqf7vbvj3080037aa7.jpg" width="200rpx">   </p>
<h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><ul>
<li>内容：Java互联网架构基础知识  </li>
<li>时间：2019.05-07 - 2019.07.05  </li>
<li>背景：软件学院大三下学期9学分<a href="http://sc.neu.edu.cn/2019/0328/c99a90425/page.htm" target="_blank" rel="noopener">企业项目实训</a></li>
</ul>
<h2 id="Contents"><a href="#Contents" class="headerlink" title="Contents"></a>Contents</h2><ul>
<li><a href="#day-1---day-3-mybatis">Day 1 - Day 3: MyBatis</a></li>
<li><a href="#day-4---day-5-spring-ioc">Day 4 - Day 5: Spring IOC</a></li>
<li><a href="#day-6---day-7-spring-aop">Day 6 - Day 7: Spring AOP</a> </li>
<li><a href="#day-8---day-x-spring-mvc">Day 8 - Day X: Spring MVC</a></li>
<li>Learning…</li>
</ul>
<h2 id="Warning"><a href="#Warning" class="headerlink" title="Warning"></a>Warning</h2><p>⚠️<strong>受本人学识所限，本项目笔记的学习意义不大，更多地可作为同期课程同学对课堂知识的一个回顾即课程讲义😋</strong>  </p>
<h2 id="Contribution"><a href="#Contribution" class="headerlink" title="Contribution"></a>Contribution</h2><p><strong>欢迎各位大佬在<a href="https://github.com/Raven98/Neuedu" target="_blank" rel="noopener">本项目</a>发起PR或在Issues里留言邀请您成为协作者，共同完善本文档</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/Raven98/Neuedu.git</span><br></pre></td></tr></table></figure></p>
<hr>
<p>为了获得更优阅读体验，您可移步至我的博客：<br><a href="https://ravenxu.top/2019/05/07/%E4%B8%9C%E8%BD%AF%E7%9D%BF%E9%81%93%E5%AE%9E%E8%AE%AD%E6%9D%82%E8%AE%B0/">东软睿道实训杂记</a></p>
<h1 id="Day-1-Day-3-MyBatis"><a href="#Day-1-Day-3-MyBatis" class="headerlink" title="Day 1 - Day 3: MyBatis"></a>Day 1 - Day 3: MyBatis</h1><ul>
<li><a href="https://github.com/Raven98/Neuedu/tree/master/TestMyBatis" target="_blank" rel="noopener">参考代码</a></li>
<li><a href="http://www.mybatis.org/mybatis-3/" target="_blank" rel="noopener">MyBatis 英文文档</a></li>
<li><a href="http://www.mybatis.org/mybatis-3/zh/getting-started.html" target="_blank" rel="noopener">MyBatis 中文文档</a><br><em>本文内容很大程度地参考了官方文档，mybatis有中文版本的文档并且极其简洁，推荐阅读</em></li>
</ul>
<h2 id="1-了解MyBatis"><a href="#1-了解MyBatis" class="headerlink" title="1. 了解MyBatis"></a>1. 了解MyBatis</h2><ul>
<li>优秀的持久层框架</li>
<li>支持定制化 SQL、存储过程以及高级映射</li>
<li>避免了几乎所有的 JDBC 代码和手动设置参数以及获取结果集</li>
<li>使用简单的 XML 或注解来配置和映射原生类型、接口和 Java 的 POJO（Plain Old Java Objects，普通老式 Java 对象）为数据库中的记录</li>
</ul>
<a id="more"></a>
<h2 id="2-传统的JDBC"><a href="#2-传统的JDBC" class="headerlink" title="2. 传统的JDBC"></a>2. 传统的JDBC</h2><p>MyBatis是对JDBC的封装，使用JDBC我们需要以下步骤：</p>
<h3 id="2-1-Load-driver-into-memory-注册驱动"><a href="#2-1-Load-driver-into-memory-注册驱动" class="headerlink" title="2.1. Load driver into memory 注册驱动"></a>2.1. Load driver into memory 注册驱动</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="2-2-Get-connection-from-database-创建connection"><a href="#2-2-Get-connection-from-database-创建connection" class="headerlink" title="2.2. Get connection from database 创建connection"></a>2.2. Get connection from database 创建connection</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Connection conn = DriverManager.getConnection(<span class="string">"jdbc:mysql://localhost:3306/scott"</span>, <span class="string">"root"</span>, <span class="string">"root"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="2-3-Create-preparedStatement-to-write-a-Sql"><a href="#2-3-Create-preparedStatement-to-write-a-Sql" class="headerlink" title="2.3. Create preparedStatement to write a Sql"></a>2.3. Create preparedStatement to write a Sql</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PreparedStatement stat = conn.prepareStatement(<span class="string">"select * from dept where deptno = ?"</span>);</span><br></pre></td></tr></table></figure>
<h3 id="2-4-Replace-all-with-actual-value"><a href="#2-4-Replace-all-with-actual-value" class="headerlink" title="2.4. Replace all ? with actual value"></a>2.4. Replace all ? with actual value</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stat.setInt(<span class="number">1</span>, <span class="number">10</span>);</span><br></pre></td></tr></table></figure>
<h3 id="2-5-execute-sql"><a href="#2-5-execute-sql" class="headerlink" title="2.5 execute sql"></a>2.5 execute sql</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ResultSet rs = stat.executeQuery();</span><br></pre></td></tr></table></figure>
<h3 id="2-6-get-the-result"><a href="#2-6-get-the-result" class="headerlink" title="2.6. get the result"></a>2.6. get the result</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(rs.next())</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">int</span> deptno = rs.getInt(<span class="string">"deptno"</span>);</span><br><span class="line">	String dname = rs.getString(<span class="string">"dname"</span>);</span><br><span class="line">	String loc = rs.getString(<span class="string">"loc"</span>);</span><br><span class="line">	</span><br><span class="line">	System.out.println(deptno+<span class="string">"\t"</span>+dname+<span class="string">"\t"</span>+loc);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-试一试MyBatis"><a href="#3-试一试MyBatis" class="headerlink" title="3. 试一试MyBatis"></a>3. 试一试MyBatis</h2><h3 id="3-1-从-XML-中构建-SqlSessionFactory"><a href="#3-1-从-XML-中构建-SqlSessionFactory" class="headerlink" title="3.1. 从 XML 中构建 SqlSessionFactory"></a>3.1. 从 XML 中构建 SqlSessionFactory</h3><p>每个基于 MyBatis 的应用都是以一个 SqlSessionFactory 的实例为核心的。SqlSessionFactory 的实例可以通过 SqlSessionFactoryBuilder 获得。而 SqlSessionFactoryBuilder 则可以从 XML 配置文件或一个预先定制的 Configuration 的实例构建出 SqlSessionFactory 的实例。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">InputStream inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">            SqlSessionFactory sqlSessionFactory =</span><br><span class="line">                    <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br></pre></td></tr></table></figure></p>
<p>也可以不从XML而是直接在Java中构建SqlSessionFactory，不做详细讨论。</p>
<h3 id="3-2-从-SqlSessionFactory-中获取-SqlSession"><a href="#3-2-从-SqlSessionFactory-中获取-SqlSession" class="headerlink" title="3.2. 从 SqlSessionFactory 中获取 SqlSession"></a>3.2. 从 SqlSessionFactory 中获取 SqlSession</h3><p>既然有了 SqlSessionFactory，顾名思义，我们就可以从中获得 SqlSession 的实例了。SqlSession 完全包含了面向数据库执行 SQL 命令所需的所有方法。你可以通过 SqlSession 实例来直接执行已映射的 SQL 语句。例如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SqlSession session = sqlSessionFactory.openSession();</span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dept d = session.selectOne(<span class="string">"com/neuedu/model/DeptMapper.java.selectDept"</span>, <span class="number">20</span>);</span><br><span class="line">System.out.println(d.getDeptno()+<span class="string">"\t"</span>+d.getDname()+<span class="string">"\t"</span>+d.getLoc());</span><br></pre></td></tr></table></figure>
<p>诚然，这种方式能够正常工作，并且对于使用旧版本 MyBatis 的用户来说也比较熟悉。不过现在有了一种更简洁的方式 ——使用正确描述每个语句的参数和返回值的接口（比如 DeptMapper.class），你现在不仅可以执行更清晰和类型安全的代码，而且还不用担心易错的字符串字面值以及强制类型转换。<br>例如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DeptMapper mapper = session.getMapper(DeptMapper.class);</span><br><span class="line">Dept d = mapper.selectDept(<span class="number">20</span>);</span><br><span class="line">System.out.println(d.getDeptno()+<span class="string">"\t"</span>+d.getDname()+<span class="string">"\t"</span>+d.getLoc());</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>新旧方式对比(个人理解)<br><img src="http://ws3.sinaimg.cn/large/006tNc79ly1g2sifw8z3tj30fz0aujrd.jpg" alt=""><br>旧方式业务代码直接根据(namespace+id)调用XML里面的某一个方法<br>新方式将XML和接口双向绑定，业务代码不需要知道XML文件内容，直接调用接口。<br>一个显而易见的变化就是旧方式的namespace随便写，而新方式必须为xml文件所在路径<br>第二种方法有很多优势，首先它不依赖于字符串字面值，会更安全一点； 其次，如果你的 IDE 有代码补全功能，那么代码补全可以帮你快速选择<strong>已映射的 SQL 语句</strong>。<br>这样做的好处在学习初期还不能完全理解，随着学习的加深能逐渐领悟  </p>
</blockquote>
<h3 id="3-3-获取查询结果"><a href="#3-3-获取查询结果" class="headerlink" title="3.3. 获取查询结果"></a>3.3. 获取查询结果</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//to iterate this list</span></span><br><span class="line">Iterator&lt;Dept&gt; it = d.iterator();</span><br><span class="line"><span class="keyword">while</span>(it.hasNext())</span><br><span class="line">&#123;</span><br><span class="line">    Dept item = it.next();</span><br><span class="line">    <span class="comment">//output its content</span></span><br><span class="line">    System.out.println(item.getDeptno()+<span class="string">"\t"</span>+item.getDname()+<span class="string">"\t"</span>+item.getLoc());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-对比JDBC和MyBatis"><a href="#4-对比JDBC和MyBatis" class="headerlink" title="4. 对比JDBC和MyBatis"></a>4. 对比JDBC和MyBatis</h2><p>直观的代码改变是MyBatis需要一个主XML配置文件，需要根据业务需求写一些mapper XML文件，需要为每个mapper XML文件编写对应的接口文件，需要为数据库内实体编写对应的Java类。<br>多了很多文件，但一定有很多好处：<br><a href="https://www.cnblogs.com/love-Stefanie/p/6838269.html" target="_blank" rel="noopener">参考资料</a></p>
<h3 id="4-1-优化获取和释放"><a href="#4-1-优化获取和释放" class="headerlink" title="4.1. 优化获取和释放"></a>4.1. 优化获取和释放</h3><p>我们一般在访问数据库时都是通过数据库连接池来操作数据库，数据库连接池有好几种，比如C3P0、DBCP，也可能采用容器本身的JNDI数据库连接池。我们可以通过DataSource进行隔离解耦，我们统一从DataSource里面获取数据库连接，DataSource具体由DBCP实现还是由容器的JNDI实现都可以，所以我们将DataSource的具体实现通过让用户配置来应对变化。</p>
<h3 id="4-2-SQL统一管理，对数据库进行存取操作"><a href="#4-2-SQL统一管理，对数据库进行存取操作" class="headerlink" title="4.2. SQL统一管理，对数据库进行存取操作"></a>4.2. SQL统一管理，对数据库进行存取操作</h3><p>我们使用JDBC对数据库进行操作时，SQL查询语句分布在各个Java类中，这样可读性差，不利于维护，当我们修改Java类中的SQL语句时要重新进行编译。<br>Mybatis可以把SQL语句放在配置文件中统一进行管理，以后修改配置文件，也不需要重新就行编译部署。</p>
<h3 id="4-3-生成动态SQL语句"><a href="#4-3-生成动态SQL语句" class="headerlink" title="4.3. 生成动态SQL语句"></a>4.3. 生成动态SQL语句</h3><p>我们在查询中可能需要根据一些属性进行组合查询，比如我们进行商品查询，我们可以根据商品名称进行查询，也可以根据发货地进行查询，或者两者组合查询。如果使用JDBC进行查询，这样就需要写多条SQL语句。<br>Mybatis可以在配置文件中通过使用<code>&lt;if test=””&gt;&lt;/if&gt;</code>标签进行SQL语句的拼接，生成动态SQL语句。比如下面这个例子：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCountByInfo"</span> <span class="attr">parameterType</span>=<span class="string">"User"</span> <span class="attr">resultType</span>=<span class="string">"int"</span>&gt;</span></span><br><span class="line">        select count(*) from user</span><br><span class="line">        <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"nickname!=null"</span>&gt;</span></span><br><span class="line">                and nickname = #&#123;nickname&#125; </span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"email!=null"</span>&gt;</span></span><br><span class="line">                and email = #&#123;email&#125; </span><br><span class="line">            <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>就是通过昵称或email或者二者的组合查找用户数。  </p>
<h3 id="4-4-能够对结果集进行映射（手动-gt-自动）"><a href="#4-4-能够对结果集进行映射（手动-gt-自动）" class="headerlink" title="4.4. 能够对结果集进行映射（手动-&gt;自动）"></a>4.4. 能够对结果集进行映射（手动-&gt;自动）</h3><p>我们在使用JDBC进行查询时，返回一个结果集ResultSet，我们要从结果集中取出结果封装为需要的类型。<br>在Mybatis中我们可以设置将结果<strong>直接</strong>映射为自己需要的类型，比如：JavaBean对象、一个Map、一个List等等。</p>
<h2 id="5-对mybatis-config-xml-主配置文件-的配置简化"><a href="#5-对mybatis-config-xml-主配置文件-的配置简化" class="headerlink" title="5. 对mybatis-config.xml(主配置文件)的配置简化"></a>5. 对mybatis-config.xml(主配置文件)的配置简化</h2><h3 id="5-1-使用properties管理变量"><a href="#5-1-使用properties管理变量" class="headerlink" title="5.1. 使用properties管理变量"></a>5.1. 使用properties管理变量</h3><p>数据库driver url username password等<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver=com.mysql.cj.jdbc.Driver</span><br><span class="line">url=jdbc:mysql://localhost:3306/scott</span><br><span class="line">username=root</span><br><span class="line">password=root</span><br></pre></td></tr></table></figure></p>
<p>在mybatis-config.xml中导入<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Load db.properties--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="5-2-使用类型别名"><a href="#5-2-使用类型别名" class="headerlink" title="5.2. 使用类型别名"></a>5.2. 使用类型别名</h3><p>resultType省去路径前缀<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.neuedu.model.po"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="5-3-一次引入所有mapper文件"><a href="#5-3-一次引入所有mapper文件" class="headerlink" title="5.3. 一次引入所有mapper文件"></a>5.3. 一次引入所有mapper文件</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"./mapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>不过我在intellij里没一次导入成功，貌似找不到路径，只得挨个导入mapper<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"mapper/DeptMapper.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"mapper/EmpMapper.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"mapper/ScoresMapper.xml"</span>&gt;</span><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="6-使用log-4j日志管理工具"><a href="#6-使用log-4j日志管理工具" class="headerlink" title="6. 使用log.4j日志管理工具"></a>6. 使用log.4j日志管理工具</h2><p><a href="https://blog.csdn.net/u013870094/article/details/79518028" target="_blank" rel="noopener">最详细的Log4J使用教程</a></p>
<h3 id="6-1-配置文件"><a href="#6-1-配置文件" class="headerlink" title="6.1. 配置文件"></a>6.1. 配置文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Global logging configuration</span><br><span class="line">log4j.rootLogger=DEBUG, stdout</span><br><span class="line"># MyBatis logging configuration...</span><br><span class="line">log4j.logger.org.mybatis.example.BlogMapper=TRACE</span><br><span class="line"># Console output...</span><br><span class="line">log4j.appender.stdout=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.stdout.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n</span><br></pre></td></tr></table></figure>
<p>### </p>
<h2 id="7-尝试更多sql"><a href="#7-尝试更多sql" class="headerlink" title="7. 尝试更多sql"></a>7. 尝试更多sql</h2><ol>
<li>like语句</li>
<li>更多变量</li>
<li>插入</li>
<li>插入递增字段</li>
<li>插入一个对象instance</li>
<li>指定返回字段</li>
<li>利用hashmap传参</li>
<li>update</li>
<li>delete</li>
<li>多表查询<ul>
<li>返回值不能是po了</li>
<li>在涉及到的表的mapper选一个。一般选主要的一个</li>
</ul>
</li>
</ol>
<h2 id="8-Result-Maps"><a href="#8-Result-Maps" class="headerlink" title="8. Result Maps"></a>8. Result Maps</h2><p>hashmap或者po作为返回值需要字段名与属性名一致，但有时数据库字段的user_id和Java属性的驼峰式userId不一样，需要有一个映射(不用resultmap的话也可以在sql里用别名关键字<code>as</code>)</p>
<h3 id="8-1-一对一多表查询"><a href="#8-1-一对一多表查询" class="headerlink" title="8.1. 一对一多表查询"></a>8.1. 一对一多表查询</h3><h3 id="8-2-一对多多表查询"><a href="#8-2-一对多多表查询" class="headerlink" title="8.2. 一对多多表查询"></a>8.2. 一对多多表查询</h3><h3 id="8-3-多对多多表查询"><a href="#8-3-多对多多表查询" class="headerlink" title="8.3. 多对多多表查询"></a>8.3. 多对多多表查询</h3><h3 id="8-4-LazyLoading"><a href="#8-4-LazyLoading" class="headerlink" title="8.4. LazyLoading"></a>8.4. LazyLoading</h3><h3 id="8-5-利用-lt-sql-gt-替换重复sql代码"><a href="#8-5-利用-lt-sql-gt-替换重复sql代码" class="headerlink" title="8.5. 利用&lt;sql&gt;替换重复sql代码"></a>8.5. 利用<code>&lt;sql&gt;</code>替换重复sql代码</h3><h3 id="8-6-字符串替换"><a href="#8-6-字符串替换" class="headerlink" title="8.6. 字符串替换"></a>8.6. 字符串替换</h3><p>因为Preparestatement后sql的结构不变</p>
<blockquote>
<p>#和$的区别  </p>
<p>理解「sql结构与变量」的概念<br>$可以改变sql的结构有sql注入的风险</p>
</blockquote>
<h2 id="9-动态SQL"><a href="#9-动态SQL" class="headerlink" title="9. 动态SQL"></a>9. 动态SQL</h2><h3 id="9-1-试一下传统方法"><a href="#9-1-试一下传统方法" class="headerlink" title="9.1. 试一下传统方法"></a>9.1. 试一下传统方法</h3><p>需要大量判断或者多次查询</p>
<h3 id="9-2-if标签"><a href="#9-2-if标签" class="headerlink" title="9.2. if标签"></a>9.2. if标签</h3><p>省去了判断根据属性的顺序传值的部分代码，但还是需要写不同if的and代码<br>利用where + if标签完成<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByConditions"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">    select * from emp</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"empno != 0"</span>&gt;</span></span><br><span class="line">            and empno = #&#123;empno&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"ename != null"</span>&gt;</span></span><br><span class="line">            and ename = #&#123;ename&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"job != null"</span>&gt;</span></span><br><span class="line">            and job = #&#123;job&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="9-3-choose-when-otherwise-switch-case-default"><a href="#9-3-choose-when-otherwise-switch-case-default" class="headerlink" title="9.3. choose + when + otherwise (switch case default)"></a>9.3. choose + when + otherwise (switch case default)</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByOneCondition"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">    select * from emp</span><br><span class="line">    <span class="tag">&lt;<span class="name">where</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">choose</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"empno != 0"</span>&gt;</span></span><br><span class="line">                and empno = #&#123;empno&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"ename != null"</span>&gt;</span></span><br><span class="line">                and ename = #&#123;ename&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">when</span> <span class="attr">test</span>=<span class="string">"job != null"</span>&gt;</span></span><br><span class="line">                and job = #&#123;job&#125;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">when</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">choose</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">where</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="9-4-Dynamic-Update"><a href="#9-4-Dynamic-Update" class="headerlink" title="9.4. Dynamic Update"></a>9.4. Dynamic Update</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateEmpByCondition"</span>&gt;</span></span><br><span class="line">    update emp</span><br><span class="line">    <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"ename != null"</span>&gt;</span></span><br><span class="line">            ename = #&#123;ename&#125;,</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"job != null"</span>&gt;</span></span><br><span class="line">            job = #&#123;job&#125;,</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    where empno = #&#123;empno&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="9-5-foreach"><a href="#9-5-foreach" class="headerlink" title="9.5. foreach"></a>9.5. foreach</h3><h3 id="9-6-分页-limit"><a href="#9-6-分页-limit" class="headerlink" title="9.6. 分页 limit"></a>9.6. 分页 limit</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByPage"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">    select * from emp limit #&#123;index&#125;, #&#123;count&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="10-MyBatis-Cache"><a href="#10-MyBatis-Cache" class="headerlink" title="10. MyBatis Cache"></a>10. MyBatis Cache</h2><p>mybatis的性能是不如JDBC的，但是它通过cache等操作尽力提升了性能(虽然还是差jdbc很多)<br><strong>demo</strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">queryByPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    SqlSession session = DBUtils.getInstance();</span><br><span class="line">    EmpMapper mapper = session.getMapper(EmpMapper.class);</span><br><span class="line"></span><br><span class="line">    List&lt;Emp&gt; emps = mapper.getEmpByPage(<span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span>(Emp e : emps) &#123;</span><br><span class="line">        System.out.println(e.getEmpno() + <span class="string">"\t"</span> + e.getEname() + <span class="string">"\t"</span> + e.getJob());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// this time, get data from cache</span></span><br><span class="line">    <span class="comment">// by default, data will be cached and shared in one session</span></span><br><span class="line">    <span class="comment">// if you create two different sessions, data can not be shared</span></span><br><span class="line">    List&lt;Emp&gt; emps2 = mapper.getEmpByPage(<span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">for</span>(Emp e : emps) &#123;</span><br><span class="line">        System.out.println(e.getEmpno() + <span class="string">"\t"</span> + e.getEname() + <span class="string">"\t"</span> + e.getJob());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>如下图所示，同一个session里的同样的sql语句只被执行一次<br><img src="http://ws1.sinaimg.cn/large/006tNc79ly1g2uw4nfuc0j31wk0bkwit.jpg" alt=""></p>
<h2 id="11-Maven-Project"><a href="#11-Maven-Project" class="headerlink" title="11. Maven Project"></a>11. Maven Project</h2><p>优点</p>
<ul>
<li>在一个位置管理全部依赖包<ul>
<li>只需写几行代码，导入方便</li>
<li>自动将依赖的jar一次性下载完毕</li>
<li>发送给别人方便，不需要附带依赖的jar包，接收方可以根据pom.xml自行导入依赖</li>
</ul>
</li>
<li>有mvn命令，便于打包发布持续集成自动化构建</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><h3 id="附1：本单元补充知识点"><a href="#附1：本单元补充知识点" class="headerlink" title="附1：本单元补充知识点"></a>附1：本单元补充知识点</h3><h4 id="1-iBatis"><a href="#1-iBatis" class="headerlink" title="1. iBatis"></a>1. iBatis</h4><h4 id="2-Java-Bean"><a href="#2-Java-Bean" class="headerlink" title="2. Java Bean"></a>2. Java Bean</h4><h4 id="3-sql-date-and-utils-date"><a href="#3-sql-date-and-utils-date" class="headerlink" title="3. sql.date and utils.date"></a>3. sql.date and utils.date</h4><p><a href="https://www.cnblogs.com/IamThat/p/3264234.html" target="_blank" rel="noopener">java.util.Date和java.sql.Date的区别及应用</a></p>
<h4 id="4-SQL注入与Preparestatement"><a href="#4-SQL注入与Preparestatement" class="headerlink" title="4. SQL注入与Preparestatement"></a>4. SQL注入与Preparestatement</h4><p><a href="https://www.cnblogs.com/yaochc/p/4957833.html" target="_blank" rel="noopener">预处理prepareStatement是怎么防止sql注入漏洞的？</a></p>
<h3 id="附2：一点思考"><a href="#附2：一点思考" class="headerlink" title="附2：一点思考"></a>附2：一点思考</h3><ol>
<li>MyBatis底层还是对JDBC的封装，查看运行日志可知最终运行的还是sql代码，只不过使用mybatis可以帮助我们更好地管理复杂的数据库访问代码，以更贴近Java本身的设计思想的方式还访问数据库。  </li>
<li>XML 接口文件 理解这些文件的作用需要领悟<strong>映射</strong>的概念。<br>一个mapper.mxl对应一个接口文件对应一个数据库的表</li>
<li>MyBatis<br>MyBatis作为一个框架，还是对现有接口的封装，可以参考轻量级框架<a href="https://www.sql2o.org/" target="_blank" rel="noopener">sql2o</a>的设计思想自行设计一个框架</li>
<li>存储过程的使用场景：阿里巴巴Java开发手册明确写明了禁止使用存储过程，究其原因更多是因为存储过程代码可读性极差、debug困难，对于阿里这样的大企业有其他措施弥补性能；对于东软这样的外包公司，如果是一个<strong>需求明确</strong>的任务还是可以写存储过程的，毕竟因为存储过程在数据库内一次性完成多个操作性能会更好。</li>
</ol>
<h1 id="Day-4-Day-5-Spring-IOC"><a href="#Day-4-Day-5-Spring-IOC" class="headerlink" title="Day 4 - Day 5: Spring IOC"></a>Day 4 - Day 5: Spring IOC</h1><ul>
<li><a href="https://github.com/Raven98/Neuedu/tree/master/SpringCore" target="_blank" rel="noopener">参考代码(基于XML)</a>  </li>
<li><a href="https://github.com/Raven98/Neuedu/tree/master/testspringannotation" target="_blank" rel="noopener">参考代码(基于注解)</a>  </li>
<li><a href="https://docs.spring.io/spring/docs/5.1.6.RELEASE/spring-framework-reference/core.html" target="_blank" rel="noopener">Spring官方文档</a>  </li>
<li><a href="https://www.kancloud.cn/winter1981/spring/543484" target="_blank" rel="noopener">费老师著作</a></li>
</ul>
<h2 id="1-了解Spring-IOC"><a href="#1-了解Spring-IOC" class="headerlink" title="1. 了解Spring IOC"></a>1. 了解Spring IOC</h2><h3 id="1-1-IOC-invertion-of-control"><a href="#1-1-IOC-invertion-of-control" class="headerlink" title="1.1. IOC: invertion of control"></a>1.1. IOC: invertion of control</h3><h4 id="Demo-for-IOC"><a href="#Demo-for-IOC" class="headerlink" title="Demo for IOC"></a>Demo for IOC</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestService</span> </span>&#123;</span><br><span class="line">    <span class="comment">// IOC inversion of control, also called DI(dependency injection)</span></span><br><span class="line">    <span class="keyword">private</span> TestDAO testDAO;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTestDAO</span><span class="params">(TestDAO testDAO)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.testDAO = testDAO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//get a instance of TestService from Spring</span></span><br><span class="line">        <span class="comment">//ask spring for instance</span></span><br><span class="line">        <span class="comment">//create a Spring container,</span></span><br><span class="line">        ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">        <span class="comment">//get instance from Spring container</span></span><br><span class="line">        <span class="comment">//by default, spring uses singleton mode</span></span><br><span class="line">        TestService service = (TestService)context.getBean(<span class="string">"testService"</span>);</span><br><span class="line">        TestService service2 = (TestService)context.getBean(<span class="string">"testService"</span>);</span><br><span class="line">        TestService service3 = (TestService)context.getBean(<span class="string">"testService"</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(service);</span><br><span class="line">        System.out.println(service2);</span><br><span class="line">        System.out.println(service3);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Ouput"><a href="#Ouput" class="headerlink" title="Ouput"></a>Ouput</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">testspringcore.TestService@6d4b1c02</span><br><span class="line">testspringcore.TestService@6d4b1c02</span><br><span class="line">testspringcore.TestService@6d4b1c02</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>
<p>IOC的目的是要让Sring来创建我们所需要的对象，不需要通过new建立。我们在applicationContext.xml配置Java bean对象即可被spring所调用。Spring默认使用单例模式。（上面的hash值指向同一个对象）由Spring所创建的对象被放到Spring的容器中。</p>
<h3 id="1-2-单例模式-Singleton"><a href="#1-2-单例模式-Singleton" class="headerlink" title="1.2.单例模式 Singleton"></a>1.2.单例模式 Singleton</h3><blockquote>
<p>单例模式与静态类<br>观点一：（单例 ）<br>单例模式比静态方法有很多优势：<br>首先，单例可以继承类，实现接口，而静态类不能（可以集成类，但不能集成实例成员）；<br>其次，单例可以被延迟初始化，静态类一般在第一次加载是初始化；<br>再次，单例类可以被集成，他的方法可以被覆写；<br>最后，或许最重要的是，单例类可以被用于多态而无需强迫用户只假定唯一的实例。举个例子，你可能在开始时只写一个配置，但是以后你可能需要支持超过一个配 置集，或者可能需要允许用户从外部从外部文件中加载一个配置对象，或者编写自己的。你的代码不需要关注全局的状态，因此你的代码会更加灵活。</p>
<p>观点二：（静态方法 ） 静态方法中产生的对象，会随着静态方法执行完毕而释放掉，而且执行类中的静态方法时，不会实例化静态方法所在的类。如果是用singleton,   产生的那一个唯一的实例，会一直在内存中，不会被GC清除的(原因是静态的属性变量不会被GC清除)，除非整个JVM退出了。这个问题我之前也想几天，并 且自己写代码来做了个实验。</p>
<p>观点三：（Good！ ）<br>由于DAO的初始化，会比较占系统资源的，如果用静态方法来取，会不断地初始化和释放，所以我个人认为如果不存在比较复杂的事务管理，用 singleton会比较好。个人意见，欢迎各位高手指正。<br>参考链接:<br><a href="https://www.cnblogs.com/zhtao_tony/p/3956047.html" target="_blank" rel="noopener">静态类和单例模式区别</a></p>
</blockquote>
<h2 id="2-管理bean的生命周期"><a href="#2-管理bean的生命周期" class="headerlink" title="2. 管理bean的生命周期"></a>2. 管理bean的生命周期</h2><p>对Spring调用bean构造方法的探究(告诉Spring 如何构造对象)</p>
<h3 id="2-1-重写构造方法加入打印调用，发现的确有输出"><a href="#2-1-重写构造方法加入打印调用，发现的确有输出" class="headerlink" title="2.1 重写构造方法加入打印调用，发现的确有输出"></a>2.1 重写构造方法加入打印调用，发现的确有输出</h3><h3 id="2-2-将构造器声明为private也能被创建"><a href="#2-2-将构造器声明为private也能被创建" class="headerlink" title="2.2 将构造器声明为private也能被创建"></a>2.2 将构造器声明为private也能被创建</h3><p><a href="https://blog.csdn.net/tiwerbao/article/details/20838903" target="_blank" rel="noopener">反射破坏单例的私有构造函数保护</a><br>帮助理解Spring为何能做到这点</p>
<h3 id="2-3-三种构造方法-告诉Spring怎样构建对象"><a href="#2-3-三种构造方法-告诉Spring怎样构建对象" class="headerlink" title="2.3. 三种构造方法(告诉Spring怎样构建对象)"></a>2.3. 三种构造方法(告诉Spring怎样构建对象)</h3><h4 id="2-3-1-直接调用Constructor-Instantiation-with-a-Constructor"><a href="#2-3-1-直接调用Constructor-Instantiation-with-a-Constructor" class="headerlink" title="2.3.1. 直接调用Constructor(Instantiation with a Constructor)"></a>2.3.1. 直接调用Constructor(Instantiation with a Constructor)</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"testDAO"</span> <span class="attr">class</span>=<span class="string">"testspringcore.TestDAO"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>最普通的方法，默认新建单例模式的对象，标签内增加<code>scope=&quot;prototype&quot;</code>可以允许新建多个实例。<br>Spring会在最初的<code>ApplicationContext context = new ClassPathXmlApplicationContext(&quot;applicationContext.xml&quot;);</code><br>步骤自动创建所有被注册的单例模式的Java bean，标签内增加<code>lazy-init=&quot;true&quot;</code>则指定在需要时在创建。  </p>
<h4 id="2-3-2-绑定getInstance-Instantiation-with-a-Static-Factory-Method"><a href="#2-3-2-绑定getInstance-Instantiation-with-a-Static-Factory-Method" class="headerlink" title="2.3.2. 绑定getInstance() (Instantiation with a Static Factory Method)"></a>2.3.2. 绑定getInstance() (Instantiation with a Static Factory Method)</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"testBean"</span> <span class="attr">class</span>=<span class="string">"testspringcore.TestBean"</span> <span class="attr">factory-method</span>=<span class="string">"getInstance"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这种方法的好处是可以手动规定创建实例的方法，例如通过绑定如下getInstance方法可以规定该类最多被创建10次。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//only have ten instance</span></span><br><span class="line"><span class="comment">//This class has the function of producing instance</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestBean</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TestBean <span class="title">getInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"factory method invoked"</span>);</span><br><span class="line">        <span class="keyword">if</span>(count&lt;<span class="number">10</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            count++;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> TestBean();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="2-3-3-绑定Factory-class-Instantiation-by-Using-an-Instance-Factory-Method"><a href="#2-3-3-绑定Factory-class-Instantiation-by-Using-an-Instance-Factory-Method" class="headerlink" title="2.3.3. 绑定Factory.class (Instantiation by Using an Instance Factory Method)"></a>2.3.3. 绑定Factory.class (Instantiation by Using an Instance Factory Method)</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- register factory bean --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"testBean2Factory"</span> <span class="attr">class</span>=<span class="string">"testspringcore.TestBean2Factory"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- register testbean2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"testBean2"</span> <span class="attr">factory-bean</span>=<span class="string">"testBean2Factory"</span> <span class="attr">factory-method</span>=<span class="string">"getInstance"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>与方法2类似，不过这时我们为要新建的bean类构造了一个对应的Factory类。</p>
<h2 id="3-管理bean的依赖（依赖注入-Dependency-Injection）"><a href="#3-管理bean的依赖（依赖注入-Dependency-Injection）" class="headerlink" title="3. 管理bean的依赖（依赖注入 Dependency Injection）"></a>3. 管理bean的依赖（依赖注入 Dependency Injection）</h2><p>可以理解为「管理bean的生命周期」是创建一个实例，「管理bean的依赖」是对这个实例的属性值进行初始化。</p>
<h3 id="3-1-使用XML方式实现依赖注入-2种方式"><a href="#3-1-使用XML方式实现依赖注入-2种方式" class="headerlink" title="3.1. 使用XML方式实现依赖注入(2种方式)"></a>3.1. 使用XML方式实现依赖注入(2种方式)</h3><p>spring会在创建@bean testService之前先创建一个它要依赖的bean的实例</p>
<h4 id="3-1-1-setter注入（常用）"><a href="#3-1-1-setter注入（常用）" class="headerlink" title="3.1.1. setter注入（常用）"></a>3.1.1. setter注入（常用）</h4><p><em>applicationContext.xml</em><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"testDAO"</span> <span class="attr">class</span>=<span class="string">"testspringcore.TestDAO"</span> <span class="attr">lazy-init</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"testService"</span> <span class="attr">class</span>=<span class="string">"testspringcore.TestService"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testDAO"</span> <span class="attr">ref</span>=<span class="string">"testDAO"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>多个属性即多行<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"testDAO"</span> <span class="attr">class</span>=<span class="string">"testspringcore.TestDAO"</span> <span class="attr">lazy-init</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userDAO"</span> <span class="attr">class</span>=<span class="string">"testspringcore.UserDAO"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"testService"</span> <span class="attr">class</span>=<span class="string">"testspringcore.TestService"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"testDAO"</span> <span class="attr">ref</span>=<span class="string">"testDAO"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"userDAO"</span> <span class="attr">ref</span>=<span class="string">"userDAO"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><code>&lt;property&gt;</code>标签内的name对应的是testService的属性，ref对应的是该xml文件其他bean的id<br>TestService类需要有各个属性的setter<br><em>TestService.java</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> TestDAO testDAO;</span><br><span class="line"><span class="keyword">private</span> UserDAO userDAO;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTestDAO</span><span class="params">(TestDAO testDAO)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.testDAO = testDAO;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUserDAO</span><span class="params">(UserDAO userDAO)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.userDAO = userDAO;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>此处的setter一定要严格遵守setter方法名命名规范「set+Property驼峰式」，可以用IDE自带的代码生成工具生成setter。</p>
<h4 id="3-1-2-构造注入"><a href="#3-1-2-构造注入" class="headerlink" title="3.1.2. 构造注入"></a>3.1.2. 构造注入</h4><p>（1）普通构造注入<br><em>applicationContext.xml</em><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"testDAO"</span> <span class="attr">class</span>=<span class="string">"testspringcore.TestDAO"</span> <span class="attr">lazy-init</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"userDAO"</span> <span class="attr">class</span>=<span class="string">"testspringcore.UserDAO"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"testService"</span> <span class="attr">class</span>=<span class="string">"testspringcore.TestService"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"testDAO"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"userDAO"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>constructor-arg的顺序与构造器参数顺序不用保持一致，可以自动识别，但是如果有重复类型的属性或者有原始类型的属性，需要注明对应关系。<br><em>TestService.java</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> TestDAO testDAO;</span><br><span class="line"><span class="keyword">private</span> UserDAO userDAO;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">TestService</span><span class="params">(UserDAO userDAO, TestDAO testDAO)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.userDAO = userDAO;</span><br><span class="line">    <span class="keyword">this</span>.testDAO = testDAO;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>（2）有简单类型的构造注入<br>有简单数据类型的构造注入：</p>
<blockquote>
<p>简单数据类型 = 原始类型 + String（String虽然是reference类型但是有很多原始类型的特征）  </p>
</blockquote>
<p><em>applicationContext.xml</em><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"exampleBean"</span> <span class="attr">class</span>=<span class="string">"testspringcore.ExampleBean"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"7500000"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">value</span>=<span class="string">"42"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>value内必须用引号，体现不出数据类型，可以用<code>type</code>属性注明</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"exampleBean"</span> <span class="attr">class</span>=<span class="string">"testspringcore.ExampleBean"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"int"</span> <span class="attr">value</span>=<span class="string">"7500000"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> <span class="attr">value</span>=<span class="string">"42"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>可以使用<code>index</code>属性注明传参数据增强可读性</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"exampleBean"</span> <span class="attr">class</span>=<span class="string">"testspringcore.ExampleBean"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">value</span>=<span class="string">"7500000"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"1"</span> <span class="attr">value</span>=<span class="string">"42"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>利用<code>name</code>属性注明构造器参数名</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"exampleBean"</span> <span class="attr">class</span>=<span class="string">"testspringcore.ExampleBean"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"years"</span> <span class="attr">value</span>=<span class="string">"7500000"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">name</span>=<span class="string">"ultimateAnswer"</span> <span class="attr">value</span>=<span class="string">"42"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>setter注入也是可以注入简单类型的，不多做介绍</p>
</li>
<li>什么时候简单类型需要被注入？<br>如果我们的代码只被自己使用，其实可以直接在类的属性里给简单数据类型初始化赋值，但是例如如果我们要使用jar包分享我们的代码给其他人使用，就应该利用xml文件进行依赖注入，因为这样不需要重新编译代码，jar包内是二进制文件不是java源代码是不能被修改的。<h4 id="3-1-3-setter注入-vs-构造器注入"><a href="#3-1-3-setter注入-vs-构造器注入" class="headerlink" title="3.1.3. setter注入 vs 构造器注入"></a>3.1.3. setter注入 vs 构造器注入</h4></li>
<li>spring官方文档推荐构造器注入</li>
<li>费老师实际工作常用setter注入</li>
<li>具体使用哪一种方法应该由团队成员讨论后由leader决定</li>
</ul>
<h4 id="3-1-4-collection作为参数"><a href="#3-1-4-collection作为参数" class="headerlink" title="3.1.4. collection作为参数"></a>3.1.4. collection作为参数</h4><p>collection包括：</p>
<ul>
<li>list</li>
<li>set</li>
<li>map</li>
</ul>
<p><em>ExampleBean.java</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line"><span class="keyword">private</span> Set&lt;String&gt; set;</span><br><span class="line"><span class="keyword">private</span> Map&lt;String, String&gt; map;</span><br></pre></td></tr></table></figure></p>
<p>增加三个集合属性<br><em>applicationContext.xml</em><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"exampleBean"</span> <span class="attr">class</span>=<span class="string">"testspringcore.ExampleBean"</span> <span class="attr">p:years</span>=<span class="string">"7500000"</span> <span class="attr">p:ultimateAnswer</span>=<span class="string">"42"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>str1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>str2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>str3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"set"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>strset1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>strset2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>strset3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"an entry"</span> <span class="attr">value</span>=<span class="string">"just some string"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span> =<span class="string">"a ref"</span> <span class="attr">value</span>=<span class="string">"myDataSource"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><code>p:preperty</code>是另一种更简单的方式用来注入简单数据类型  </p>
<blockquote>
<p>我们一般不常用集合，但是有时候引用的jar包需要我们以collection的方式注入。</p>
</blockquote>
<h4 id="3-1-5-properties读取"><a href="#3-1-5-properties读取" class="headerlink" title="3.1.5. properties读取"></a>3.1.5. properties读取</h4><p>类似集合，常用类似方法读取properties配置<br><em>applicationContext.xml</em><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"adminEmails"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"administrator"</span>&gt;</span>administrator@example.org<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"support"</span>&gt;</span>support@example.org<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"development"</span>&gt;</span>development@example.org<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="3-1-6-depends-on"><a href="#3-1-6-depends-on" class="headerlink" title="3.1.6. depends-on"></a>3.1.6. depends-on</h4><p>之前我们用ref来指明依赖的类，但有时这种依赖关系不是很明显，这要求我们用<code>depends-on</code>属性强制指明依赖的类。<br><em>applicationContext.xml</em><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"beanOne"</span> <span class="attr">class</span>=<span class="string">"ExampleBean"</span> <span class="attr">depends-on</span>=<span class="string">"manager"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"manager"</span> <span class="attr">class</span>=<span class="string">"ManagerBean"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><code>depends-on</code>内可用分隔符分隔指明多个依赖关系</p>
<h4 id="3-1-7-Lazy-initialized-beans"><a href="#3-1-7-Lazy-initialized-beans" class="headerlink" title="3.1.7. Lazy-initialized beans"></a>3.1.7. Lazy-initialized beans</h4><p>前面我们已经提到过，这代表延迟加载单例bean<br>以前我们不这样做，但是现在内存等硬件条件上升，我们常常对单例实例不使用延迟加载，我们用空间换时间，为了更好性能。<br><em>程序使用<code>ClassPathXmlApplicationContext()</code>注入时只默认注入全部的单例类，非单例类我们不知道该创建多少个，也没必要提前创建</em></p>
<h3 id="3-2-使用注解方式实现依赖注入"><a href="#3-2-使用注解方式实现依赖注入" class="headerlink" title="3.2. 使用注解方式实现依赖注入"></a>3.2. 使用注解方式实现依赖注入</h3><ul>
<li>@Component-&gt;通用组件<br>泛指组件，当组件不好归类的时候，我们可以使用这个注解进行标注。</li>
<li>@Controller-&gt;控制器<br>用于标注控制层组件（如struts中的action）</li>
<li>@Service-&gt; Service<br>用于标注业务层组件</li>
<li>@Repository -&gt; DAO<br>用于标注数据访问组件，即DAO组件<br><em>@Component泛指所有组件，其他三个是拥有特殊语义的注解</em><br><em>Spring鼓励使用其他三个更具有语义化的注解，会在日后支持提供feature</em></li>
</ul>
<h4 id="3-2-1-demo"><a href="#3-2-1-demo" class="headerlink" title="3.2.1. demo"></a>3.2.1. demo</h4><p><em>applicationContext.xml</em><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- specify where beans locate --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"testspringannotation"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>此时的xml配置文件很简洁，指明了我们用注解的方式来注入依赖。<br><em>TestController.java</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//we are sure, Spring uses Java Reflection mechanism to update its private field</span></span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> TestService testService;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">outputcollaborators</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//invoke method the service</span></span><br><span class="line">		testService.outputinfo();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
</blockquote>
<h4 id="3-2-2-Autowired"><a href="#3-2-2-Autowired" class="headerlink" title="3.2.2. @Autowired"></a>3.2.2. @Autowired</h4><blockquote>
<p>wire, 装载；装配<br>autowired, 自动装载  </p>
</blockquote>
<p>我们用<code>@Autowired</code>注明哪些类需要被注入，方式有很多种：</p>
<ol>
<li><p>在构造器上方注明</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MovieRecommender</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> CustomerPreferenceDao customerPreferenceDao;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MovieRecommender</span><span class="params">(CustomerPreferenceDao customerPreferenceDao)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.customerPreferenceDao = customerPreferenceDao;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在setter函数上方注明</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleMovieLister</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> MovieFinder movieFinder;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMovieFinder</span><span class="params">(MovieFinder movieFinder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.movieFinder = movieFinder;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在具有任意名称和多个参数的方法上方注明</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MovieRecommender</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> MovieCatalog movieCatalog;</span><br><span class="line">        <span class="keyword">private</span> CustomerPreferenceDao customerPreferenceDao;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Autowired</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">prepare</span><span class="params">(MovieCatalog movieCatalog,</span></span></span><br><span class="line"><span class="function"><span class="params">                CustomerPreferenceDao customerPreferenceDao)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.movieCatalog = movieCatalog;</span><br><span class="line">            <span class="keyword">this</span>.customerPreferenceDao = customerPreferenceDao;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="number">4</span>. 在成员变量fields上注明，甚至可以混用注解方法</span><br><span class="line">    ```java</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MovieRecommender</span> </span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">final</span> CustomerPreferenceDao customerPreferenceDao;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Autowired</span></span><br><span class="line">        <span class="keyword">private</span> MovieCatalog movieCatalog;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Autowired</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MovieRecommender</span><span class="params">(CustomerPreferenceDao customerPreferenceDao)</span> </span>&#123;</span><br><span class="line">           <span class="keyword">this</span>.customerPreferenceDao = customerPreferenceDao;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p> 显然，在成员变量上使用<code>@Autowired</code>用到了Java的反射机制。这种方法有一套机制去唯一标识注入的对象，通常先byType，若有冲突再转而byName。</p>
<h3 id="3-3-思考"><a href="#3-3-思考" class="headerlink" title="3.3. 思考"></a>3.3. 思考</h3><h4 id="3-3-1-框架设计原则：约定优于配置"><a href="#3-3-1-框架设计原则：约定优于配置" class="headerlink" title="3.3.1. 框架设计原则：约定优于配置"></a>3.3.1. 框架设计原则：约定优于配置</h4><p>例如约定bean默认不延迟加载。事无巨细的配置降低了框架的便利性。</p>
<h4 id="3-3-2-MVC"><a href="#3-3-2-MVC" class="headerlink" title="3.3.2. MVC"></a>3.3.2. MVC</h4><p><img src="http://ws3.sinaimg.cn/large/006tNc79ly1g2w91nprxrj31000mewkd.jpg" width="500rpx">   </p>
</li>
</ol>
<p>MVC是所有web项目为了实现“高内聚，低耦合”应遵循的模式。  </p>
<h4 id="3-3-3-对比基于XML与基于注解的注入方式"><a href="#3-3-3-对比基于XML与基于注解的注入方式" class="headerlink" title="3.3.3. 对比基于XML与基于注解的注入方式"></a>3.3.3. 对比基于XML与基于注解的注入方式</h4><ul>
<li>显然有各自的优缺点</li>
<li>不能因为基于注解的方式是较新的就认为它更好</li>
<li><a href="http://blog.csdn.net/y6s6y6y/article/details/80992833" target="_blank" rel="noopener">参考资料:spring注解和xml配置的优缺点比较</a></li>
<li>官方文档：<ul>
<li>注解更贴近代码，有更多context，配置更短更精确；</li>
<li>但是违反了POJO的模式，配置变得分散更难控制；</li>
<li>Spring支持两种方式混用，结合各自的有点做出更好的配置；</li>
<li>值得指出的是，通过其JavaConfig选项，Spring允许以非侵入方式使用注释，而无需触及目标组件源代码，并且在工具方面，Spring Tool Suite支持所有配置样式。</li>
</ul>
</li>
</ul>
<h4 id="3-3-4-再议依赖注入"><a href="#3-3-4-再议依赖注入" class="headerlink" title="3.3.4. 再议依赖注入"></a>3.3.4. 再议依赖注入</h4><p><a href="https://zhuanlan.zhihu.com/p/29426019" target="_blank" rel="noopener">用小说的形式讲解为什么需要依赖注入</a></p>
<blockquote>
<p>Spring框架的核心功能之一就是通过依赖注入的方式来管理Bean之间的依赖关系。那么我们今天的主角依赖注入到底有什么神奇之处呢？请往下继续看。<br>了解过设计模式的朋友肯定知道工厂模式吧，即所有的对象的创建都交给工厂来完成，是一个典型的面向接口编程。这比直接用new直接创建对象更合理，因为直接用new创建对象，会导致调用者与被调用者的硬编码耦合；而工厂模式，则把责任转向了工厂，形成调用者与被调用者的接口的耦合，这样就避免了类层次的硬编码耦合。这样的工厂模式确实比传统创建对象好很多。但是，正如之前所说的，工厂模式只是把责任推给了工厂，造成了调用者与被调用者工厂的耦合。<br>Spring框架则避免了调用者与工厂之间的耦合，通过spring容器“宏观调控”，调用者只要被动接受spring容器为调用者的成员变量赋值即可，而不需要主动获取被依赖对象。这种被动获取的方式就叫做依赖注入，又叫控制反转。依赖注入又分为设值注入和构造注入。而spring框架则负责通过配置xml文件来实现依赖注入。而设值注入和构造注入则通过配置上的差异来区分。</p>
</blockquote>
<p><strong>依赖注入 == 控制反转</strong></p>
<h1 id="Day-6-Day-7-Spring-AOP"><a href="#Day-6-Day-7-Spring-AOP" class="headerlink" title="Day 6 - Day 7: Spring AOP"></a>Day 6 - Day 7: Spring AOP</h1><h2 id="1-了解AOP"><a href="#1-了解AOP" class="headerlink" title="1. 了解AOP"></a>1. 了解AOP</h2><h3 id="1-1-名词解释"><a href="#1-1-名词解释" class="headerlink" title="1.1. 名词解释"></a>1.1. 名词解释</h3><ul>
<li>AOP: Aspect-Oriented Programming: 面向切面编程<br>分布于应用中多处的功能称为横切关注点，通过这些横切关注点在概念上是与应用的业务逻辑相分离的，但其代码往往直接嵌入在应用的业务逻辑之中。将这些横切关注点与业务逻辑相分离正是面向切面编程（AOP）所要解决的。切面实现了横切关注点的模块化<br>一句话概括：切面是跟具体业务无关的一类共同功能。</li>
<li>advice: 通知</li>
<li>pointcut: 切入点</li>
<li>weaving: 织入</li>
</ul>
<h2 id="2-配置"><a href="#2-配置" class="headerlink" title="2. 配置"></a>2. 配置</h2><p>这里我们不用xml用注解配置，例如<code>@Before(&quot;execution(* com.neuedu.model.service.AccountService.*(..))&quot;)</code></p>
<h3 id="2-1-Before"><a href="#2-1-Before" class="headerlink" title="2.1. @Before"></a>2.1. @Before</h3><h3 id="2-2-AfterReturning"><a href="#2-2-AfterReturning" class="headerlink" title="2.2. @AfterReturning"></a>2.2. @AfterReturning</h3><h3 id="2-3-AfterThrowing"><a href="#2-3-AfterThrowing" class="headerlink" title="2.3. @AfterThrowing"></a>2.3. @AfterThrowing</h3><p>业务方法一定要抛出异常（try catch throw / throws）皆可，否则<code>@AfterThrowing</code>注解无法起作用。</p>
<h3 id="2-4-After"><a href="#2-4-After" class="headerlink" title="2.4. @After"></a>2.4. @After</h3><h3 id="2-5-执行顺序探究"><a href="#2-5-执行顺序探究" class="headerlink" title="2.5. 执行顺序探究"></a>2.5. 执行顺序探究</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="comment">//@Before</span></span><br><span class="line">        method.invoke(..);</span><br><span class="line">    &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">        <span class="comment">//@After</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//@AfterReturning</span></span><br><span class="line">&#125;<span class="keyword">catch</span>()&#123;</span><br><span class="line">    <span class="comment">//@AfterThrowing</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@After</code>和<code>@AfterReturning</code>注解的执行顺序以及生成的动态代理类结果在新版本中有变化，有待进一步探究。<br><a href="http://www.imooc.com/qadetail/75298" target="_blank" rel="noopener">aop after-returning 和after的区别？</a></p>
<h2 id="3-Demo"><a href="#3-Demo" class="headerlink" title="3.Demo"></a>3.Demo</h2><p>JDBC事务处理是经常使用AOP的一个典型事例（其他还有诸如日志等），我们举例对比使用AOP前后代码量与代码结构的变化。</p>
<h3 id="3-1-使用切面之前"><a href="#3-1-使用切面之前" class="headerlink" title="3.1. 使用切面之前"></a>3.1. 使用切面之前</h3><p><em>DBUtils.java</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBUtils</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> ThreadLocal&lt;Connection&gt; tl = <span class="keyword">new</span> ThreadLocal&lt;&gt;();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">static</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//加载数据库驱动</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			Class.forName(<span class="string">"com.mysql.jdbc.Driver"</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">beginTransaction</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//1.得到数据库连接</span></span><br><span class="line">		Connection conn = getConnection();</span><br><span class="line">		<span class="comment">//2.设置自动提交为false    </span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			conn.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		Connection conn = tl.get();</span><br><span class="line">		<span class="keyword">if</span>(conn==<span class="keyword">null</span>)</span><br><span class="line">		&#123;			</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				conn = DriverManager.</span><br><span class="line">						getConnection(<span class="string">"jdbc:mysql://localhost:3306/mydb?useUnicode=true&amp;characterEncoding=utf8"</span>, <span class="string">"root"</span>, <span class="string">"root"</span>);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">				<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">				e.printStackTrace();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//放在本地线程</span></span><br><span class="line">			tl.set(conn);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> conn;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">commit</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//1.得到数据库连接</span></span><br><span class="line">		Connection conn = getConnection();</span><br><span class="line">		<span class="comment">//2. 提交</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			conn.commit();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">rollback</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//1.得到数据库连接</span></span><br><span class="line">		Connection conn = getConnection();</span><br><span class="line">		<span class="comment">//2. 提交</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			conn.rollback();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//1.得到数据库连接</span></span><br><span class="line">		Connection conn = getConnection();</span><br><span class="line">		<span class="comment">//2. 提交</span></span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			conn.close();</span><br><span class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//3.把conn从tl中移除</span></span><br><span class="line">		tl.remove();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>使用<code>ThreadLocal</code>：保证连接是共享的，同一个连接</p>
<p><em>Service类 Service.java</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountService</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	AccountDAO accountDAO;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transferMoney</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;		</span><br><span class="line">		<span class="comment">//1. 获得数据库连接，开启事务</span></span><br><span class="line">		DBUtils.beginTransaction();</span><br><span class="line">		<span class="keyword">try</span></span><br><span class="line">		&#123;			</span><br><span class="line">			accountDAO.deduct();</span><br><span class="line">			accountDAO.add();</span><br><span class="line">			</span><br><span class="line">			DBUtils.commit();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">catch</span>(Exception e)</span><br><span class="line">		&#123;</span><br><span class="line">			DBUtils.rollback();</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">finally</span></span><br><span class="line">		&#123;</span><br><span class="line">			DBUtils.close();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="comment">//1. 开启spring容器</span></span><br><span class="line">		ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">		</span><br><span class="line">		AccountService accountService = (AccountService)context.getBean(<span class="string">"accountService"</span>);</span><br><span class="line">		</span><br><span class="line">		accountService.transferMoney();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>AccountDAO.java</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountDAO</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deduct</span><span class="params">()</span> <span class="keyword">throws</span> SQLException</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//1. 获得连接</span></span><br><span class="line">		Connection conn = DBUtils.getConnection();</span><br><span class="line">		</span><br><span class="line">		PreparedStatement ps = conn.prepareStatement(<span class="string">"update account set balance = balance-10 where accountid =2"</span>);</span><br><span class="line">	    ps.executeUpdate();	     </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">()</span> <span class="keyword">throws</span> SQLException</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//1. 获得连接</span></span><br><span class="line">		Connection conn = DBUtils.getConnection();</span><br><span class="line">		</span><br><span class="line">		PreparedStatement ps = conn.prepareStatement(<span class="string">"update account set balance = balance+10 where accountid =1"</span>);</span><br><span class="line">	    ps.executeUpdate();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="3-2-使用切面之后"><a href="#3-2-使用切面之后" class="headerlink" title="3.2. 使用切面之后"></a>3.2. 使用切面之后</h3><p><em>切面类 TransactionAspect.java</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransactionAspect</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Before</span>(<span class="string">"execution(* com.neuedu.model.service.AccountService.*(..))"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getConnection</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		DBUtils.getConnection();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@AfterReturning</span>(<span class="string">"execution(* com.neuedu.model.service.AccountService.*(..))"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">commitConnection</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		DBUtils.commitConnection();</span><br><span class="line">		DBUtils.closeConnection();</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@AfterThrowing</span>(<span class="string">"execution(* com.neuedu.model.service.AccountService.*(..))"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rollbackConnection</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		DBUtils.rollbackConnection();</span><br><span class="line">		DBUtils.closeConnection();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@After</span>(<span class="string">"execution(* com.neuedu.model.service.AccountService.*(..))"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">closeConnection</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		DBUtils.closeConnection();		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><em>Service类 MyService.java</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyService</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function">      </span>&#123;       </span><br><span class="line">           MyDAO myDAO = <span class="keyword">new</span> MyDAO();</span><br><span class="line">           myDAO.deduct();          </span><br><span class="line">           myDAO.add();         </span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>可见，Service类被简化了，目前Service只有一个方法，显然可以预测随着业务的增多Service将提供越来越多的业务函数，利用切面将只关注真正的业务逻辑而不再需要写context比较低的代码。</p>
<h2 id="3-探究AOP实现机制：动态代理"><a href="#3-探究AOP实现机制：动态代理" class="headerlink" title="3. 探究AOP实现机制：动态代理"></a>3. 探究AOP实现机制：动态代理</h2><p><strong>注意:</strong> AOP不是代码拷贝，是方法调用<br>有两种动态代理方式</p>
<h3 id="3-1-运行时创建临时对象"><a href="#3-1-运行时创建临时对象" class="headerlink" title="3.1. 运行时创建临时对象"></a>3.1. 运行时创建临时对象</h3><ul>
<li>方法1: 实现一个接口，spring直接调用jdk，创建一个类，实现一个接口</li>
<li>方法2: 没实现接口，spring调用内置的cglib</li>
</ul>
<h3 id="3-2-编译过程修改编译生成的class文件"><a href="#3-2-编译过程修改编译生成的class文件" class="headerlink" title="3.2. 编译过程修改编译生成的class文件"></a>3.2. 编译过程修改编译生成的class文件</h3><ul>
<li>Aspectj修改.class文件</li>
<li>Spring AOP依赖IOC</li>
</ul>
<h2 id="4-Around"><a href="#4-Around" class="headerlink" title="4. @Around"></a>4. @Around</h2><p>利用<code>@Around</code>我们可以显式地指明语句插入的位置，利用<code>@Around</code>代替上面的四个注解完成JDBC事务管理如下：<br><em>TranscationAspect.java</em><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Around</span>(<span class="string">"execution(* com.neuedu.model.service.AccountService.*(..))"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(ProceedingJoinPoint pjp)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">	DBUtils.getConnection();</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		pjp.proceed();</span><br><span class="line"></span><br><span class="line">		DBUtils.commitConnection();</span><br><span class="line">	&#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">		System.out.println(e);</span><br><span class="line"></span><br><span class="line">		DBUtils.rollbackConnection();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">throw</span> e;</span><br><span class="line">	&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">		DBUtils.closeConnection();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>我们可以看到，这和前四个注解共同使用的实现逻辑类似，其中传入参数<code>ProceedingJoinPoint pjp</code>代表切入点<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="comment">//@Before</span></span><br><span class="line">        method.invoke(..);</span><br><span class="line">    &#125;<span class="keyword">finally</span>&#123;</span><br><span class="line">        <span class="comment">//@After</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//@AfterReturning</span></span><br><span class="line">&#125;<span class="keyword">catch</span>()&#123;</span><br><span class="line">    <span class="comment">//@AfterThrowing</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>只不过利用<code>@Around</code>注解我们手动实现了其中的 try, finally, catch关系，这有助于我们更好地理解AOP切入的位置。</p>
<h2 id="5-XML配置"><a href="#5-XML配置" class="headerlink" title="5. XML配置"></a>5. XML配置</h2><p>下面再来尝试不用注解用XML配置切面<br>使用场景</p>
<ul>
<li>用了jar包里的Aspect类</li>
<li>xml配置便于集中管理</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogAspect</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//before the method executes:</span></span><br><span class="line">		System.out.println(<span class="string">"methods before"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//after the method executes:</span></span><br><span class="line">		System.out.println(<span class="string">"methods after"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterthrowing</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"methods exception"</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterreturnning</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		System.out.println(<span class="string">"methods runs without exception"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-Advisor顾问"><a href="#6-Advisor顾问" class="headerlink" title="6. Advisor顾问"></a>6. Advisor顾问</h2><p>Advisor顾问：只有一个方法的Aspect切面<br>（因为<code>@Around</code>很流行，使用很多切面类里只有一个方法，如果一个切面只有一个advice，我们叫它advisor。）</p>
<h3 id="6-1-配置方法"><a href="#6-1-配置方法" class="headerlink" title="6.1. 配置方法"></a>6.1. 配置方法</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"transactionAdvisor"</span> <span class="attr">pointcut</span>=<span class="string">"execution(* com.neuedu.model.service.AccountService.*(..))"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransactionAdvisor</span> <span class="keyword">implements</span> <span class="title">MethodInterceptor</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * because a advisor only have one advice, to specify the type of the advice, </span></span><br><span class="line"><span class="comment">	 * you must implements different interface.</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * because we must implement a interface, this is called invasive design（侵入式设计） </span></span><br><span class="line"><span class="comment">	 * which is actually not good.</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(MethodInvocation arg0)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		</span><br><span class="line">		DBUtils.getConnection();</span><br><span class="line">		<span class="keyword">try</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//call our business logic</span></span><br><span class="line">			<span class="comment">//dao.deductMoney();</span></span><br><span class="line">			<span class="comment">//dao.addMoney();</span></span><br><span class="line">			arg0.proceed();</span><br><span class="line">			</span><br><span class="line">			DBUtils.commitConnection();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">			<span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			</span><br><span class="line">			DBUtils.rollbackConnection();</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">throw</span> e;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">finally</span></span><br><span class="line">		&#123;</span><br><span class="line">			DBUtils.closeConnection();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过实现接口代表是哪一种切面</p>
<h3 id="6-2-优点"><a href="#6-2-优点" class="headerlink" title="6.2. 优点"></a>6.2. 优点</h3><ul>
<li>配置简化</li>
<li>便于使用第三方切面</li>
</ul>
<h3 id="6-3-小结"><a href="#6-3-小结" class="headerlink" title="6.3. 小结"></a>6.3. 小结</h3><p>这体现了框架是在不断演变的，框架设计者也在不断根据用户使用情况及反馈调整框架的设计。如此例，设计者发现很多只有一个方法的切面类也需要繁琐的<br>配置因而引入了顾问的概念帮助简化这些只有一个方法的切面的配置。<br>各种主流框架一般都支持xml配置和注解配置，xml配置和注解配置是两套并行的配置方法。Java在5.0版本中引入了注解，之后注解迅速流行，但是对于<br>一些早期项目，考虑到项目稳定性以及团队成员的学习问题还更喜欢xml，当然xml配置也有自身的有点，在上面提到过最显著的两点。</p>
<h2 id="7-MyBatis-Spring"><a href="#7-MyBatis-Spring" class="headerlink" title="7. MyBatis + Spring"></a>7. MyBatis + Spring</h2><p><strong>核心问题：</strong>MyBatis实现IOC由Spring创建并控制</p>
<blockquote>
<p>数据库连接池</p>
</blockquote>
<h3 id="7-1-分析配置文件"><a href="#7-1-分析配置文件" class="headerlink" title="7.1. 分析配置文件"></a>7.1. 分析配置文件</h3><p>由配置文件即可看出配置的思想：配置SqlSession Fac<br><em>applicationContext.xml</em><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">"http://www.springframework.org/schema/aop"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">        https://www.springframework.org/schema/tx/spring-tx.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!--注明通过注解来配置AOP--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.neuedu.model.service"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- to enable AOP aspect weave --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:aspectj-autoproxy</span>&gt;</span><span class="tag">&lt;/<span class="name">aop:aspectj-autoproxy</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- connect spring with mybatis --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 配置数据源，类似于属性文件，下面会用到，使用了dbcp2数据连接池 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"ds"</span> <span class="attr">class</span>=<span class="string">"org.apache.commons.dbcp2.BasicDataSource"</span> <span class="attr">destroy-method</span>=<span class="string">"close"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"com.mysql.cj.jdbc.Driver"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"jdbc:mysql://localhost:3306/scott"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"root"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment">&lt;!-- (1) --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- configure MyBatis sessionFactory --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 配置MyBatis的sessionFactory，将其交由Spring管理 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 加载mybatis的主配置文件 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis-config.xml"</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 注入数据源 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"ds"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment">&lt;!-- (2) --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- tell Spring about Mapper information --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- MyBatis: 指定mapper，即可用的DAO方法 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 指定扫描的包名，如果扫描多个包，每个包中间使用半角逗号分隔--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.neuedu.model.mapper"</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 自动创建session（connection）去数据库交互 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactoryBeanName"</span> <span class="attr">value</span>=<span class="string">"sessionFactory"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment">&lt;!-- (3) --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 以下为Spring AOP的配置 --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- configure Spring transaction manager which is a advisor --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 配置AOP，该事务AOP由Spring提供 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"txm"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"ds"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- if we want to use annotation to control transaction --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 指定利用注解的方式配置 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"txm"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>分析利用Spring来管理MyBatis的配置文件需要回想之前手动管理MyBatis的步骤</p>
<ul>
<li><p>(1) 配置MyBatis的sessionFactory<br>之前我们采用如下方式新建sessionFactory</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String resource = <span class="string">"mybatis-config.xml"</span>;</span><br><span class="line">InputStream inputStream;</span><br><span class="line">SqlSession session = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 1. Create a sqlsessionFactory</span></span><br><span class="line">    inputStream = Resources.getResourceAsStream(resource);</span><br><span class="line">    SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>(2) 指定可以使用的mapper实现</p>
</li>
<li>(3) 配置Spring AOP<br><strong>这其中，之前由我们手写的例如TransactionManager切面类等都由Spring提供的类来实现！配置一次后其他的使用就很简单了！</strong><br><strong>初次接触配置文件可能比较陌生，想要理解好要回想不用Spring框架我们要做哪些工作</strong></li>
</ul>
<h2 id="8-总结"><a href="#8-总结" class="headerlink" title="8. 总结"></a>8. 总结</h2><h3 id="8-1-补充知识点"><a href="#8-1-补充知识点" class="headerlink" title="8.1. 补充知识点"></a>8.1. 补充知识点</h3><ul>
<li><p>判断是否是同一个对象：打印对象地址。</p>
</li>
<li><p>什么时候把类加载到内存？三种情况：</p>
<ul>
<li>new类的对象</li>
<li>调用类的静态方法</li>
<li><code>Class.forName(&quot;&quot;);</code></li>
</ul>
</li>
<li><p>JDBC事务</p>
<blockquote>
<p>事务是必须满足4个条件（ACID）<br>事务的原子性（ Atomicity）：一组事务，要么成功；要么撤回。<br>  一致性 （Consistency）：事务执行后，数据库状态与其他业务规则保持一致。如转账业务，无论事务执行成功否，参与转账的两个账号余额之和应该是不变的。<br>  隔离性（Isolation）：事务独立运行。一个事务处理后的结果，影响了其他事务，那么其他事务会撤回。事务的100%隔离，需要牺牲速度。<br>  持久性（Durability）：软、硬件崩溃后，InnoDB数据表驱动会利用日志文件重构修改。可靠性和高速度不可兼得， innodb_flush_log_at_trx_commit 选项 决定什么时候吧事务保存到日志里。</p>
</blockquote>
</li>
<li><p>DML<br>SQL分为DML数据库操纵语言（SELECT INSERT DELETE UPDATE）和DDL数据库定义语言（创建表时的一些定义操作ALTER等）<br>JDBC默认自动提交，即<code>executeUpdate()</code>后自动执行了commit()。但是我们想保持数据库的原子性，所以在上面通过<code>conn.setAutoCommit(false);</code>禁用自动提交。禁用后支持<code>rollback()</code>回滚操作及<code>rollback(Savepoint savepoint)</code>回滚到固定位置。数据库在<code>commit()</code>前都没被真正改变，都能通过<code>rollback()</code>撤销之前做的<code>executeUpdate()</code>操作。数据库应该只是有一个临时的镜像而已。COMMIT命令用于把事务所做的修改保存到数据库。</p>
</li>
<li><p>joinpoint &amp; pointcut<br>连接点joinpoint指方法的执行，pointcut指定位到一堆连接点</p>
<h3 id="8-2-再议异常处理"><a href="#8-2-再议异常处理" class="headerlink" title="8.2. 再议异常处理"></a>8.2. 再议异常处理</h3></li>
<li>try catch<br>自行处理</li>
<li>throws<br>交给上级处理</li>
<li>try catch + throw<br>自行处理+通知上级发生过异常</li>
</ul>
<p>不能在主方法里向上抛出异常</p>
<h3 id="8-3-数据库连接池"><a href="#8-3-数据库连接池" class="headerlink" title="8.3. 数据库连接池"></a>8.3. 数据库连接池</h3><p>7.1中的<code>ds bean</code>使用了dbcp2数据库连接池，下面我们简单介绍一下数据库连接池。戳下面的链接    </p>
<ul>
<li><a href="https://ravenxu.top/2019/05/15/%E5%88%9D%E6%8E%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0/">参考资料</a></li>
</ul>
<h3 id="8-4-一点想法"><a href="#8-4-一点想法" class="headerlink" title="8.4. 一点想法"></a>8.4. 一点想法</h3><p>在实现了Spring+MyBatis整合配置后，我惊讶的发现项目代码量减少很多，主要原因是常用的类<br>都交由Spring内置的类实现了，所以如果我们直接学习内置类使用的话就很难理解深层次的细节问题，所以还是得从头学起，了解JDBC和MyBatis的差异，了解Spring IOC怎样作为容器管理实例，了解Spring AOP怎样实现动态代理。<br>举例说明项目代码量减少，我们最后的项目不用手写数据库事务管理类，二是用了Spring提供的<code>org.springframework.jdbc.datasource.DataSourceTransactionManager</code>类，这主要是因为AOP的主流使用场景就固定那几种，Spring作为一个好用的框架自然无死角的帮助开发者少做工作，懒惰是推动技术进步的动力哈哈。</p>
<p><strong>高效学习框架知识：注重阅读文档，兼而学习底层知识。</strong></p>
<h1 id="Day-8-Day-X-Spring-MVC"><a href="#Day-8-Day-X-Spring-MVC" class="headerlink" title="Day 8 - Day X: Spring MVC"></a>Day 8 - Day X: Spring MVC</h1><h2 id="1-Spring-MVC介绍"><a href="#1-Spring-MVC介绍" class="headerlink" title="1. Spring MVC介绍"></a>1. Spring MVC介绍</h2><h3 id="1-1-回想"><a href="#1-1-回想" class="headerlink" title="1.1 回想"></a>1.1 回想</h3><p>回想之前我们学习的三个技术，加上今天要学习的Spring MVC，共同组成了一个web项目要使用的基本框架。<br>这四个技术分别应用的MVC模型中的如下部分：</p>
<ul>
<li>Spring MVC: Controller Layer</li>
<li>Spring IOC: All</li>
<li>Spring AOP: Service Layer</li>
<li>MyBatis: mapper</li>
</ul>
<p><img src="http://ws4.sinaimg.cn/large/006tNc79ly1g31razzyhxj30zw0m8418.jpg" width="500px"> </p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/实习/" rel="tag"># 实习</a>
          
            <a href="/tags/东软睿道/" rel="tag"># 东软睿道</a>
          
            <a href="/tags/Java/" rel="tag"># Java</a>
          
            <a href="/tags/互联网架构/" rel="tag"># 互联网架构</a>
          
            <a href="/tags/MyBatis/" rel="tag"># MyBatis</a>
          
            <a href="/tags/Spring-IOC/" rel="tag"># Spring IOC</a>
          
            <a href="/tags/Spring-AOP/" rel="tag"># Spring AOP</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/04/14/自动驾驶系统课程笔记/" rel="next" title="自动驾驶系统课程笔记（第一章 简介）">
                <i class="fa fa-chevron-left"></i> 自动驾驶系统课程笔记（第一章 简介）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/05/12/认真搞清楚static, final, final static/" rel="prev" title="认真搞清楚static, final, final static">
                认真搞清楚static, final, final static <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="Raven Xu" />
            
              <p class="site-author-name" itemprop="name">Raven Xu</p>
              <p class="site-description motion-element" itemprop="description">软件工程本科在读。巴萨球迷。坚定的马克思主义战士，毛中特最忠实的拥护者。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">40</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Raven98" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:xrwgood@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.linkedin.com/in/%E7%91%9E%E6%96%87-%E8%AE%B8-bb512712b/" target="_blank" title="Linkedin">
                      
                        <i class="fa fa-fw fa-linkedin"></i>Linkedin</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.instagram.com/raven_neu" target="_blank" title="Instagram">
                      
                        <i class="fa fa-fw fa-instagram"></i>Instagram</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction"><span class="nav-number">1.</span> <span class="nav-text">Introduction</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Contents"><span class="nav-number">1.1.</span> <span class="nav-text">Contents</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Warning"><span class="nav-number">1.2.</span> <span class="nav-text">Warning</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Contribution"><span class="nav-number">1.3.</span> <span class="nav-text">Contribution</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Day-1-Day-3-MyBatis"><span class="nav-number">2.</span> <span class="nav-text">Day 1 - Day 3: MyBatis</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-了解MyBatis"><span class="nav-number">2.1.</span> <span class="nav-text">1. 了解MyBatis</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-传统的JDBC"><span class="nav-number">2.2.</span> <span class="nav-text">2. 传统的JDBC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Load-driver-into-memory-注册驱动"><span class="nav-number">2.2.1.</span> <span class="nav-text">2.1. Load driver into memory 注册驱动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Get-connection-from-database-创建connection"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.2. Get connection from database 创建connection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Create-preparedStatement-to-write-a-Sql"><span class="nav-number">2.2.3.</span> <span class="nav-text">2.3. Create preparedStatement to write a Sql</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-Replace-all-with-actual-value"><span class="nav-number">2.2.4.</span> <span class="nav-text">2.4. Replace all ? with actual value</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-execute-sql"><span class="nav-number">2.2.5.</span> <span class="nav-text">2.5 execute sql</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-get-the-result"><span class="nav-number">2.2.6.</span> <span class="nav-text">2.6. get the result</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-试一试MyBatis"><span class="nav-number">2.3.</span> <span class="nav-text">3. 试一试MyBatis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-从-XML-中构建-SqlSessionFactory"><span class="nav-number">2.3.1.</span> <span class="nav-text">3.1. 从 XML 中构建 SqlSessionFactory</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-从-SqlSessionFactory-中获取-SqlSession"><span class="nav-number">2.3.2.</span> <span class="nav-text">3.2. 从 SqlSessionFactory 中获取 SqlSession</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-获取查询结果"><span class="nav-number">2.3.3.</span> <span class="nav-text">3.3. 获取查询结果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-对比JDBC和MyBatis"><span class="nav-number">2.4.</span> <span class="nav-text">4. 对比JDBC和MyBatis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-优化获取和释放"><span class="nav-number">2.4.1.</span> <span class="nav-text">4.1. 优化获取和释放</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-SQL统一管理，对数据库进行存取操作"><span class="nav-number">2.4.2.</span> <span class="nav-text">4.2. SQL统一管理，对数据库进行存取操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-生成动态SQL语句"><span class="nav-number">2.4.3.</span> <span class="nav-text">4.3. 生成动态SQL语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-能够对结果集进行映射（手动-gt-自动）"><span class="nav-number">2.4.4.</span> <span class="nav-text">4.4. 能够对结果集进行映射（手动-&gt;自动）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-对mybatis-config-xml-主配置文件-的配置简化"><span class="nav-number">2.5.</span> <span class="nav-text">5. 对mybatis-config.xml(主配置文件)的配置简化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-使用properties管理变量"><span class="nav-number">2.5.1.</span> <span class="nav-text">5.1. 使用properties管理变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-使用类型别名"><span class="nav-number">2.5.2.</span> <span class="nav-text">5.2. 使用类型别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-一次引入所有mapper文件"><span class="nav-number">2.5.3.</span> <span class="nav-text">5.3. 一次引入所有mapper文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-使用log-4j日志管理工具"><span class="nav-number">2.6.</span> <span class="nav-text">6. 使用log.4j日志管理工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-配置文件"><span class="nav-number">2.6.1.</span> <span class="nav-text">6.1. 配置文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-尝试更多sql"><span class="nav-number">2.7.</span> <span class="nav-text">7. 尝试更多sql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-Result-Maps"><span class="nav-number">2.8.</span> <span class="nav-text">8. Result Maps</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-一对一多表查询"><span class="nav-number">2.8.1.</span> <span class="nav-text">8.1. 一对一多表查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-一对多多表查询"><span class="nav-number">2.8.2.</span> <span class="nav-text">8.2. 一对多多表查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-多对多多表查询"><span class="nav-number">2.8.3.</span> <span class="nav-text">8.3. 多对多多表查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-4-LazyLoading"><span class="nav-number">2.8.4.</span> <span class="nav-text">8.4. LazyLoading</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-5-利用-lt-sql-gt-替换重复sql代码"><span class="nav-number">2.8.5.</span> <span class="nav-text">8.5. 利用&lt;sql&gt;替换重复sql代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-6-字符串替换"><span class="nav-number">2.8.6.</span> <span class="nav-text">8.6. 字符串替换</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-动态SQL"><span class="nav-number">2.9.</span> <span class="nav-text">9. 动态SQL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-试一下传统方法"><span class="nav-number">2.9.1.</span> <span class="nav-text">9.1. 试一下传统方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-if标签"><span class="nav-number">2.9.2.</span> <span class="nav-text">9.2. if标签</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-3-choose-when-otherwise-switch-case-default"><span class="nav-number">2.9.3.</span> <span class="nav-text">9.3. choose + when + otherwise (switch case default)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-4-Dynamic-Update"><span class="nav-number">2.9.4.</span> <span class="nav-text">9.4. Dynamic Update</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-5-foreach"><span class="nav-number">2.9.5.</span> <span class="nav-text">9.5. foreach</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-6-分页-limit"><span class="nav-number">2.9.6.</span> <span class="nav-text">9.6. 分页 limit</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-MyBatis-Cache"><span class="nav-number">2.10.</span> <span class="nav-text">10. MyBatis Cache</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-Maven-Project"><span class="nav-number">2.11.</span> <span class="nav-text">11. Maven Project</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">2.12.</span> <span class="nav-text">总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#附1：本单元补充知识点"><span class="nav-number">2.12.1.</span> <span class="nav-text">附1：本单元补充知识点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-iBatis"><span class="nav-number">2.12.1.1.</span> <span class="nav-text">1. iBatis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Java-Bean"><span class="nav-number">2.12.1.2.</span> <span class="nav-text">2. Java Bean</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-sql-date-and-utils-date"><span class="nav-number">2.12.1.3.</span> <span class="nav-text">3. sql.date and utils.date</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-SQL注入与Preparestatement"><span class="nav-number">2.12.1.4.</span> <span class="nav-text">4. SQL注入与Preparestatement</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#附2：一点思考"><span class="nav-number">2.12.2.</span> <span class="nav-text">附2：一点思考</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Day-4-Day-5-Spring-IOC"><span class="nav-number">3.</span> <span class="nav-text">Day 4 - Day 5: Spring IOC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-了解Spring-IOC"><span class="nav-number">3.1.</span> <span class="nav-text">1. 了解Spring IOC</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-IOC-invertion-of-control"><span class="nav-number">3.1.1.</span> <span class="nav-text">1.1. IOC: invertion of control</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Demo-for-IOC"><span class="nav-number">3.1.1.1.</span> <span class="nav-text">Demo for IOC</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Ouput"><span class="nav-number">3.1.1.2.</span> <span class="nav-text">Ouput</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-单例模式-Singleton"><span class="nav-number">3.1.2.</span> <span class="nav-text">1.2.单例模式 Singleton</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-管理bean的生命周期"><span class="nav-number">3.2.</span> <span class="nav-text">2. 管理bean的生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-重写构造方法加入打印调用，发现的确有输出"><span class="nav-number">3.2.1.</span> <span class="nav-text">2.1 重写构造方法加入打印调用，发现的确有输出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-将构造器声明为private也能被创建"><span class="nav-number">3.2.2.</span> <span class="nav-text">2.2 将构造器声明为private也能被创建</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-三种构造方法-告诉Spring怎样构建对象"><span class="nav-number">3.2.3.</span> <span class="nav-text">2.3. 三种构造方法(告诉Spring怎样构建对象)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-1-直接调用Constructor-Instantiation-with-a-Constructor"><span class="nav-number">3.2.3.1.</span> <span class="nav-text">2.3.1. 直接调用Constructor(Instantiation with a Constructor)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-2-绑定getInstance-Instantiation-with-a-Static-Factory-Method"><span class="nav-number">3.2.3.2.</span> <span class="nav-text">2.3.2. 绑定getInstance() (Instantiation with a Static Factory Method)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-3-绑定Factory-class-Instantiation-by-Using-an-Instance-Factory-Method"><span class="nav-number">3.2.3.3.</span> <span class="nav-text">2.3.3. 绑定Factory.class (Instantiation by Using an Instance Factory Method)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-管理bean的依赖（依赖注入-Dependency-Injection）"><span class="nav-number">3.3.</span> <span class="nav-text">3. 管理bean的依赖（依赖注入 Dependency Injection）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-使用XML方式实现依赖注入-2种方式"><span class="nav-number">3.3.1.</span> <span class="nav-text">3.1. 使用XML方式实现依赖注入(2种方式)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-1-setter注入（常用）"><span class="nav-number">3.3.1.1.</span> <span class="nav-text">3.1.1. setter注入（常用）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-2-构造注入"><span class="nav-number">3.3.1.2.</span> <span class="nav-text">3.1.2. 构造注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-3-setter注入-vs-构造器注入"><span class="nav-number">3.3.1.3.</span> <span class="nav-text">3.1.3. setter注入 vs 构造器注入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-4-collection作为参数"><span class="nav-number">3.3.1.4.</span> <span class="nav-text">3.1.4. collection作为参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-5-properties读取"><span class="nav-number">3.3.1.5.</span> <span class="nav-text">3.1.5. properties读取</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-6-depends-on"><span class="nav-number">3.3.1.6.</span> <span class="nav-text">3.1.6. depends-on</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-7-Lazy-initialized-beans"><span class="nav-number">3.3.1.7.</span> <span class="nav-text">3.1.7. Lazy-initialized beans</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-使用注解方式实现依赖注入"><span class="nav-number">3.3.2.</span> <span class="nav-text">3.2. 使用注解方式实现依赖注入</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-1-demo"><span class="nav-number">3.3.2.1.</span> <span class="nav-text">3.2.1. demo</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-2-Autowired"><span class="nav-number">3.3.2.2.</span> <span class="nav-text">3.2.2. @Autowired</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-思考"><span class="nav-number">3.3.3.</span> <span class="nav-text">3.3. 思考</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-1-框架设计原则：约定优于配置"><span class="nav-number">3.3.3.1.</span> <span class="nav-text">3.3.1. 框架设计原则：约定优于配置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-2-MVC"><span class="nav-number">3.3.3.2.</span> <span class="nav-text">3.3.2. MVC</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-3-对比基于XML与基于注解的注入方式"><span class="nav-number">3.3.3.3.</span> <span class="nav-text">3.3.3. 对比基于XML与基于注解的注入方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-4-再议依赖注入"><span class="nav-number">3.3.3.4.</span> <span class="nav-text">3.3.4. 再议依赖注入</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Day-6-Day-7-Spring-AOP"><span class="nav-number">4.</span> <span class="nav-text">Day 6 - Day 7: Spring AOP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-了解AOP"><span class="nav-number">4.1.</span> <span class="nav-text">1. 了解AOP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-名词解释"><span class="nav-number">4.1.1.</span> <span class="nav-text">1.1. 名词解释</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-配置"><span class="nav-number">4.2.</span> <span class="nav-text">2. 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Before"><span class="nav-number">4.2.1.</span> <span class="nav-text">2.1. @Before</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-AfterReturning"><span class="nav-number">4.2.2.</span> <span class="nav-text">2.2. @AfterReturning</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-AfterThrowing"><span class="nav-number">4.2.3.</span> <span class="nav-text">2.3. @AfterThrowing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-After"><span class="nav-number">4.2.4.</span> <span class="nav-text">2.4. @After</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-执行顺序探究"><span class="nav-number">4.2.5.</span> <span class="nav-text">2.5. 执行顺序探究</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Demo"><span class="nav-number">4.3.</span> <span class="nav-text">3.Demo</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-使用切面之前"><span class="nav-number">4.3.1.</span> <span class="nav-text">3.1. 使用切面之前</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-使用切面之后"><span class="nav-number">4.3.2.</span> <span class="nav-text">3.2. 使用切面之后</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-探究AOP实现机制：动态代理"><span class="nav-number">4.4.</span> <span class="nav-text">3. 探究AOP实现机制：动态代理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-运行时创建临时对象"><span class="nav-number">4.4.1.</span> <span class="nav-text">3.1. 运行时创建临时对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-编译过程修改编译生成的class文件"><span class="nav-number">4.4.2.</span> <span class="nav-text">3.2. 编译过程修改编译生成的class文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Around"><span class="nav-number">4.5.</span> <span class="nav-text">4. @Around</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-XML配置"><span class="nav-number">4.6.</span> <span class="nav-text">5. XML配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Advisor顾问"><span class="nav-number">4.7.</span> <span class="nav-text">6. Advisor顾问</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-配置方法"><span class="nav-number">4.7.1.</span> <span class="nav-text">6.1. 配置方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-优点"><span class="nav-number">4.7.2.</span> <span class="nav-text">6.2. 优点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-小结"><span class="nav-number">4.7.3.</span> <span class="nav-text">6.3. 小结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-MyBatis-Spring"><span class="nav-number">4.8.</span> <span class="nav-text">7. MyBatis + Spring</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-分析配置文件"><span class="nav-number">4.8.1.</span> <span class="nav-text">7.1. 分析配置文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-总结"><span class="nav-number">4.9.</span> <span class="nav-text">8. 总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-补充知识点"><span class="nav-number">4.9.1.</span> <span class="nav-text">8.1. 补充知识点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-再议异常处理"><span class="nav-number">4.9.2.</span> <span class="nav-text">8.2. 再议异常处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-3-数据库连接池"><span class="nav-number">4.9.3.</span> <span class="nav-text">8.3. 数据库连接池</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-4-一点想法"><span class="nav-number">4.9.4.</span> <span class="nav-text">8.4. 一点想法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Day-8-Day-X-Spring-MVC"><span class="nav-number">5.</span> <span class="nav-text">Day 8 - Day X: Spring MVC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Spring-MVC介绍"><span class="nav-number">5.1.</span> <span class="nav-text">1. Spring MVC介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-回想"><span class="nav-number">5.1.1.</span> <span class="nav-text">1.1 回想</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Raven Xu</span>

  
</div>


  <div class="powered-by">
  <i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
    本站访客数:<span id="busuanzi_value_site_uv"></span>
  </span>
  </div>
  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://ravenxu.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'https://ravenxu.top/2019/05/08/东软睿道实训杂记/';
          this.page.identifier = '2019/05/08/东软睿道实训杂记/';
          this.page.title = '「置顶」东软睿道实训杂记';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://ravenxu.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  





  

  

  

  
  

  

  

  

</body>
</html>
